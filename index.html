
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<link href="https://braincube-io.github.io/python-connector/" rel="canonical"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en, fr" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="images/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-4.6.3" name="generator"/>
<title>braincube_connector@2.5.0</title>
<link href="assets/stylesheets/application.adb8469c.css" rel="stylesheet"/>
<script src="assets/javascripts/modernizr.86422ebf.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="extra.css" rel="stylesheet"/>
</head>
<body dir="ltr">
<svg class="md-svg">
<defs>
<svg height="448" id="__github" viewbox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor"></path></svg>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#braincube_connector-a-python-client-for-braincube" tabindex="0">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a class="md-logo md-header-nav__button" href="" title="braincube_connector@2.5.0">
<img height="45" src="./images/braincube.png" width="45"/>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<span class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              
            
            Home
          
        </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-icon md-search__icon" for="__search"></label>
<button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/braincube-io/python-connector/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container">
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://braincube-io.github.io/python-connector/" title="braincube_connector@2.5.0">
<i class="md-icon"></i>
</a>
    braincube_connector@2.5.0
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/braincube-io/python-connector/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Home
      </label>
<a class="md-nav__link md-nav__link--active" href="." title="Home">
      Home
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#description" title="Description">
    Description
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#installation" title="Installation">
    Installation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-and-authentication" title="Configuration and Authentication">
    Configuration and Authentication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#usage" title="Usage">
    Usage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-usage" title="Advanced Usage">
    Advanced Usage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#library-parameters" title="Library parameters">
    Library parameters
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="jupyter_presentation/usage_example/" title="Usage">
      Usage
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      API Reference
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-3">
        API Reference
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/client/" title="client">
      client
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/braincube/" title="braincube">
      braincube
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/memory_base/" title="memory_base">
      memory_base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/nested_resources/job/" title="job">
      job
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/nested_resources/condition_container/" title="condition">
      condition
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/nested_resources/event/" title="event">
      event
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/nested_resources/rule/" title="rule">
      rule
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/nested_resources/variable/" title="variable">
      variable
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="reference/braincube_connector/memory_base/nested_resources/datagroup/" title="datagroup">
      datagroup
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="contributing/" title="Contributing">
      Contributing
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#description" title="Description">
    Description
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#installation" title="Installation">
    Installation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-and-authentication" title="Configuration and Authentication">
    Configuration and Authentication
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#usage" title="Usage">
    Usage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-usage" title="Advanced Usage">
    Advanced Usage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#library-parameters" title="Library parameters">
    Library parameters
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1 id="braincube_connector-a-python-client-for-braincube">braincube_connector: a python client for Braincube</h1>
<h2 id="description">Description</h2>
<p>The python package <code>braincube_connector</code> provides a tool for datascientists to access their data on Braincube directly from python.</p>
<h2 id="installation">Installation</h2>
<p>Install with pip:</p>
<div class="codehilite"><pre><span></span><code>pip install braincube_connector
</code></pre></div>
<h2 id="configuration-and-authentication">Configuration and Authentication</h2>
<p>Since version <code>2.2.0</code>, the authentication uses a personal access token (PAT).</p>
<p>In order to create a PAT, you need to go in your braincube personal <code>menu &gt; Account &gt; Access tokens &gt; +/Add</code></p>
<p>The scopes of the token should include <code>BRAINCUBE</code> and <code>SSO_READ</code>.</p>
<p>Then two options exist to pass the PAT to the braincube_connector:
 1. Using a configuration dictionary when creating a client:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">braincube_connector</span> <span class="kn">import</span> <span class="n">client</span>

<span class="n">client</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">config_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">"api_key"</span><span class="p">:</span><span class="s2">"&lt;my_personal_access_token&gt;"</span><span class="p">,</span> <span class="s2">"domain"</span><span class="p">:</span><span class="s2">"mybraincube.com"</span><span class="p">})</span>
</code></pre></div>
<ol>
<li>Using a configuration file:
 ```python
 from braincube_connector import client</li>
</ol>
<p>client.get_instance("config_file"="myfile.json")
 <code>*myfile.json*</code>json
 {"api_key":"<my_personal_access_token>", "domain":"mybraincube.com"}
 ```</my_personal_access_token></p>
<h3 id="authentication-with-an-oauth2-token">Authentication with an Oauth2 token.</h3>
<p>The <em>braincube_connector</em> used to support only this type of authentication. This is not the method we encourage
the most since the PAT is available, because the Oauth2 is obtained with the <a href="https://pypi.org/project/braincube-token-getter/">braincube-token-getter</a> that is not under active development.
However if you still want to use this method, you need to setup the configuration file (or dictionary) as follows:
<code>config.json</code></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">"client_id"</span><span class="p">:</span> <span class="s2">"app id"</span><span class="p">,</span>
    <span class="nt">"client_secret"</span><span class="p">:</span> <span class="s2">"app key"</span><span class="p">,</span>
    <span class="nt">"domain"</span><span class="p">:</span> <span class="s2">"mybraincube.com"</span><span class="p">,</span>
    <span class="nt">"verify"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">"oauth2_token"</span><span class="p">:</span> <span class="s2">"token value"</span>
<span class="p">}</span>
</code></pre></div>
<p>By default the connector searches for a PAT and uses the oauth2_token when the PAT is not present in the dictionary.</p>
<h3 id="configuration-parameters">Configuration parameters</h3>
<p>Here is a list of the settings available in the configuration file:</p>
<ul>
<li><code>domain</code>(optional if <code>sso_base_url</code> and <code>braincube_base_url</code> exist): The domain of the braincube to access.</li>
<li><code>sso_base_url</code>(optional if <code>domain</code> exists): The base URL of the SSO used to check the validity of your access token.</li>
<li><code>braincube_base_url</code>(optional if <code>domain</code> exists): The base URL of the Braincube API used to fetch data from.</li>
<li><code>api_key</code>(optional if <code>oauth2_token</code> exists): a personal access token generated in the braincube account configuration.</li>
<li><code>oauth2_token</code>(optional if <code>api_key</code> exists): an OAuth2 token obtained with the <a href="https://pypi.org/project/braincube-token-getter/">braincube-token-getter</a>. Used only when <code>api_key</code> does not exist.</li>
<li><code>verify</code>(optional, default is <code>True</code>): If <code>False</code>, the requests do not verify the SSL certificate.<blockquote>
<p>Setting <code>verify</code> to false must be used with care, it's a security threat (see <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session.verify">requests documentation</a></p>
</blockquote>
</li>
</ul>
<p>The <code>client_id</code>,  <code>client_secret</code> from the last section are used only by the <em>braincube_token_getter</em> when requesting a new OAuth token.</p>
<h3 id="note">Note:</h3>
<p>If the client is not initialized manually or if no configuration is passed to <code>get_instance</code>, the package creates a client instance from one of these two files <code>./config.json</code>  or <code>~/.braincube/config.json</code> (in this priority order) when they exist.</p>
<h2 id="usage">Usage</h2>
<h3 id="client">Client</h3>
<p>A client can be inialized manually from a custom configuration file.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">braincube_connector</span> <span class="kn">import</span> <span class="n">client</span>

<span class="n">client</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">config_file</span><span class="o">=</span><span class="s2">"pathto/config.json"</span><span class="p">)</span>
</code></pre></div>
<p><strong>Note:</strong> If the client is not initialized manually, the package creates a client instance from one of these two files <code>./config.json</code>  or <code>~/.braincube/config.json</code> (in this priority order) if they exist.</p>
<h3 id="features-of-the-connector-entities">Features of the connector entities.</h3>
<p>The connector gives access to different entities(described in more details in the following sections) that share multiple methods:</p>
<ul>
<li><code>&lt;entity&gt;.get_name()</code>: Returns the name of the entity.</li>
<li><code>&lt;entity&gt;.get_bcid()</code>: Returns the bcId identifier of the entity.</li>
<li><code>&lt;entity&gt;.get_uuid()</code>: Returns the braincube unique uuid identifier of the entity.</li>
</ul>
<h3 id="braincube">Braincube</h3>
<p>To obtain a list of all the available <code>Braincube</code> entities with a client:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">braincube_connector</span> <span class="kn">import</span> <span class="n">braincube</span>

<span class="n">braincube</span><span class="o">.</span><span class="n">get_braincube_list</span><span class="p">()</span>
</code></pre></div>
<p>Or to select a specific <code>Braincube</code> entity from its name:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bc</span> <span class="o">=</span> <span class="n">braincube</span><span class="o">.</span><span class="n">get_braincube</span><span class="p">(</span><span class="s2">"demo"</span><span class="p">)</span>
</code></pre></div>
<h3 id="memorybase">MemoryBase</h3>
<p>The list of all the memory bases available within a <code>Braincube</code> is obtained with</p>
<div class="codehilite"><pre><span></span><code><span class="n">mb_list</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">get_memory_base_list</span><span class="p">()</span>
</code></pre></div>
<p><strong>Note:</strong> The number of memory bases in a braincube can be numerous,  hence <code>get_memory_base_list</code> allows paginated requests <code>bc.get_memory_base_list(page=0)</code></p>
<p>To select a unique memory base, go with its bcId:</p>
<div class="codehilite"><pre><span></span><code><span class="n">mb</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">get_memory_base</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</code></pre></div>
<h3 id="variabledescriptions">VariableDescriptions</h3>
<p>The variable description are linked to a memory base.</p>
<div class="codehilite"><pre><span></span><code><span class="n">var_desc</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">bcid</span><span class="o">=</span><span class="s2">"2000034"</span><span class="p">)</span>
</code></pre></div>
<p>For multiple variable descriptions:</p>
<div class="codehilite"><pre><span></span><code><span class="n">mb</span><span class="o">.</span><span class="n">get_variable_list</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p><strong>Note:</strong> Similarly to memory bases, providing no argument to <code>get_variable_list</code> retrieves all the descriptions available in the memory base.</p>
<p>The type of variable is obtained with the function <code>get_type</code></p>
<div class="codehilite"><pre><span></span><code><span class="n">var_desc</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span>
</code></pre></div>
<h3 id="datagroup">DataGroup</h3>
<p>DataGroup are obtained from a memory base:</p>
<div class="codehilite"><pre><span></span><code><span class="n">datagroup</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_datagroup</span><span class="p">(</span><span class="n">bcid</span><span class="o">=</span><span class="s2">"10"</span><span class="p">)</span>
</code></pre></div>
<p>The list of the available datagroups can also be obtained with <code>mb.get_datagroup_list()</code>.</p>
<p>A datagroup is a container that includes multiple variables. They are accessed with</p>
<div class="codehilite"><pre><span></span><code><span class="n">datagroup</span><span class="o">.</span><span class="n">get_variable_ids</span><span class="p">()</span> <span class="c1"># Gets the variable bcIds</span>
<span class="n">datagroup</span><span class="o">.</span><span class="n">get_variable_list</span><span class="p">()</span> <span class="c1"># Gets the list of VariableDescription objects.</span>
</code></pre></div>
<h3 id="event">Event</h3>
<p>An event is a predifined set of conditions in braincube. It is accessed as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="n">event</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_event</span><span class="p">(</span><span class="n">bcid</span><span class="o">=</span><span class="s2">"10"</span><span class="p">)</span>
<span class="n">event_list</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_event_list</span><span class="p">()</span>
</code></pre></div>
<p>The interest of events is that you can access the conditions they contain in order create new <a href="#data-filters">filters</a> for a <code>get_data</code> function:</p>
<div class="codehilite"><pre><span></span><code><span class="n">event</span><span class="o">.</span><span class="n">get_conditions</span><span class="p">()</span>
</code></pre></div>
<h3 id="jobdescription">JobDescription</h3>
<p>The job desciption contains the settings used to build an analysis and gives a proxy to access these parameters easily. A JobDescription is obtained from a memory base as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="n">job_desc</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_job</span><span class="p">(</span><span class="n">bcid</span><span class="o">=</span><span class="s2">"573"</span><span class="p">)</span>
<span class="n">job_list</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_job_list</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p>The properties are acced with the following methods:  </p>
<ul>
<li>
<p><strong>get_conditions:</strong><br/>
  Gets a list of the conditions used to select the job variables.
  <code>python
  job_desc.get_conditions()
  job_desc.get_conditions(combine=True) # Merge the conditions into one
  job_desc.get_conditions(include_events=True) # Includes the conditions from
                                               # the job's events</code></p>
</li>
<li>
<p><strong>get_variable_ids:</strong><br/>
  Gets a list of the variables involved in the job, including the target variables and the influence variables.
  <code>python
  job_desc.get_variable_ids()</code></p>
</li>
<li>
<p><strong>get_events:</strong><br/>
  Gets a list of the event objects used by the job.
  <code>python
  job_desc.get_events()</code></p>
</li>
<li>
<p><strong>get_categories:</strong><br/>
  Gets a list of conditions used to categorise a job's data as <em>good</em> or <em>bad</em>. You may have a <em>middle</em> category, it's an old categorisation which will not be used anymore.
  <code>python
  job_desc.get_categories()</code></p>
</li>
<li>
<p><strong>get_data:</strong><br/>
  When a job is created on braincube, a separate copy of the data is made. As for now this copy is not available from the webservices. However the <code>get_data</code> method collects the job's data from the memory base using the same filters as when the job was created. Be aware that these data might be different from the job's data if the memory base has been updated since the job creation.  </p>
</li>
</ul>
<p>Similarly to other object <code>get_data</code>, a <code>filters</code> parameter is available to add additional <a href="#data-filters">filters</a> to the job's conditions.</p>
<p><code>python
  job_desc.get_data()</code></p>
<h3 id="job-rules">Job rules</h3>
<p>The job rule descriptions are obtained with the methods <code>get_rule</code> or <code>get_rule_list</code> either from a job or a memory base. The only difference being that in the case of a memory base <code>get_rule_list</code> gets all the rules existing in the memory base whereas for a job, it gets the rules specific to the job under consideration.</p>
<div class="codehilite"><pre><span></span><code><span class="n">rule</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">get_rule</span><span class="p">(</span><span class="n">bcid</span><span class="o">=</span><span class="s2">"200"</span><span class="p">)</span>
<span class="n">rule_list</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">get_rule_list</span><span class="p">()</span>
</code></pre></div>
<p>To access a <code>RuleDescription</code> object's metadata, you can calle the <code>get_metadata</code> function</p>
<div class="codehilite"><pre><span></span><code><span class="n">rule</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
</code></pre></div>
<h3 id="get-variable-data">Get variable data</h3>
<p>A memory base can also request the data for a custom set of variable ids. Adding <a href="#data-filters">filters</a> restricts the returned data to a desired subset of the data. The method is called as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">mb</span><span class="o">.</span><span class="n">get_data</span><span class="p">([</span><span class="s2">"2000001"</span><span class="p">,</span> <span class="s2">"2000034"</span><span class="p">],</span> <span class="n">filters</span><span class="o">=</span><span class="n">my_filters</span><span class="p">,</span> <span class="n">label_type</span><span class="o">=</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>The output format is a dictionary or a pandas DataFrame when the <code>dataframe</code> parameter is set to <code>True</code>. The keys/column labels are the variable bcIds or names depending on whether <code>label_type</code> is set to <code>"bcid"</code> or <code>"name"</code> respectively.</p>
<p><strong>Note:</strong> By default the dates are not parsed to <code>datetime</code> objects in order to speed up the <code>get_data</code> function but it is possible to enable the parsing:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">braincube_connector</span> <span class="kn">import</span> <span class="n">parameters</span>
<span class="n">parameters</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">({</span><span class="s2">"parse_date"</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</code></pre></div>
<h3 id="data-filters">Data filters</h3>
<p>The <code>get_data</code> methods have the option to restrict the data that are collected by using a set of filters. The <code>filters</code> parameter must be a list conditions (even for a single condition):</p>
<div class="codehilite"><pre><span></span><code><span class="nb">object</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="p">[{</span><span class="s2">"BETWEEN"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"mb20/d2000002"</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]},{</span><span class="s2">"BETWEEN"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"mb20/d2000003"</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}])</span>
</code></pre></div>
<p>Here is a selection of the most common types of filters:
- <strong>Equals to</strong><br/>
  Selects data when a variable is equal to
  <code>json
  {
    "EQUALS": [ "mb20/d2000002", 2.0]
  }</code>
- <strong>Between</strong><br/>
  Selects the data when a variable belongs to a range.
  <code>json
  {
    "BETWEEN": [ "mb20/d2000003", -1, 1]
  }</code>
- <strong>Lower than</strong><br/>
  Selects the data when a variable is lower than a certain value.
  <code>json
  {
    "LESS": [ "mb20/d2000003", 10]
  }</code>
<strong>Note:</strong> The <code>LESS_EQUALS</code> filter also exists.</p>
<ul>
<li>
<p><strong>Greater than</strong><br/>
  Selects the data when a variable is greater than a certain value.
  <code>json
  {
    "GREAT": [ "mb20/d2000003", 10]
  }</code>
<strong>Note:</strong> The <code>GREAT_EQUALS</code> filter also exists.</p>
</li>
<li>
<p><strong>Not:</strong><br/>
  The <code>NOT</code> condition creates the opposite of an existing condition.
  <code>json
  {
    "Not": [{"filter":...}]
  }</code></p>
</li>
<li>
<p><strong>And gate</strong><br/>
  It is possible to combine filters using a <em>and</em> gate.
  <code>json
  {
    "AND": [{"filter1":...}, {"filter2":...}]
  }</code>
<strong>Notes:</strong> </p>
<ul>
<li>A <code>AND</code> filter can only host two conditions. In order to join more than two filters multiple <code>AND</code> conditions should be nested one into another.</li>
<li>When multiple filters are provided in the <code>get_data</code>'s <code>filters</code> parameters, they are joined together within the function using <code>AND</code> gates.  </li>
</ul>
</li>
<li>
<p><strong>Or gate:</strong><br/>
  Similar to <code>AND</code> but uses a <code>OR</code> gate.
  <code>json
  {
    "OR": [{"filter1":...}, {"filter2":...}]
  }</code></p>
</li>
</ul>
<h2 id="advanced-usage">Advanced Usage</h2>
<p>The <em>braincube_connector</em> provides a simple interface for the most common features of the <em>braincube web-services</em> or <em>braindata</em> but it is not extensive.</p>
<p>If you need to access an endpoint of <a href="https://braincube.io/ws-doc/?urls.primaryName=Braincube%20WS"><em>braincube webservices</em></a> or <a href="https://braincube.io/ws-doc/?urls.primaryName=Braindata%20WS"><em>braindata</em></a>, the <code>request_ws</code> function of the library can help you. The function uses the configuration passed to the client creation to manage the authentication.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">braincube_connector</span> <span class="kn">import</span> <span class="n">client</span>

<span class="n">client</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">config_dict</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">json_result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">request_ws</span><span class="p">(</span><span class="s2">"braincube/demo/braindata/mb20/simple"</span><span class="p">)</span>
</code></pre></div>
<p>Most braincube requests return a json, but for a few of them it might be better to deactivate the parsing by setting the <code>response_as_json</code> parameter to <code>False</code>. In the latter case, <code>request_ws</code> returns the response object.</p>
<div class="codehilite"><pre><span></span><code><span class="n">json_result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">request_ws</span><span class="p">(</span><span class="s2">"braincube/demo/braindata/mb20/simple"</span><span class="p">,</span> <span class="n">response_as_json</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<h2 id="library-parameters">Library parameters</h2>
<p>The library parameters can be set to custom values:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">braincube_connector</span> <span class="kn">import</span> <span class="n">parameters</span>

<span class="c1"># Change the request pagination size to 10</span>
<span class="n">parameters</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">({</span><span class="s2">"page_size"</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1"># Parse dates to datetime objects</span>
<span class="n">parameters</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">({</span><span class="s2">"parse_date"</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># The Braincube database stores multiple names (`tag`, `standard`, or `local`) for a variable</span>
<span class="c1"># By default `standard` id used, but you can change it as follows:</span>
<span class="n">parameters</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(({</span><span class="s2">"VariableDescription_name_key"</span><span class="p">:</span> <span class="s2">"tag"</span><span class="p">}))</span>
</code></pre></div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="jupyter_presentation/usage_example/" rel="next" title="Usage">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Usage
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" rel="noopener" target="_blank">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs</a>
</div>
</div>
</div>
</footer>
</div>
<script src="assets/javascripts/application.c33a9706.js"></script>
<script src="assets/javascripts/lunr/lunr.stemmer.support.js"></script>
<script src="assets/javascripts/lunr/lunr.fr.js"></script>
<script src="assets/javascripts/lunr/lunr.multi.js"></script>
<script>app.initialize({version:"1.1.2",url:{base:"."}})</script>
</body>
</html>